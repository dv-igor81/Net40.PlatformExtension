Решение с проектами библиотек классов для .Net Framework4.0.
Основная часть кода взята из Net.Core 3.1 (extensions-3.1.10).